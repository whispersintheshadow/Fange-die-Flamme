
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Feuerfänger</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: sans-serif;
      background-color: #ffeecc;
    }
    canvas {
      display: block;
      margin: 0 auto;
      background: linear-gradient(#ffddaa, #ffffff);
      border: 4px solid #cc6600;
    }
    #info {
      text-align: center;
      font-size: 20px;
      margin: 10px;
    }
    button {
      display: block;
      margin: 10px auto;
      font-size: 20px;
      padding: 10px 20px;
      background: #ff9933;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="500" height="400"></canvas>
  <div id="info">
    Punkte: <span id="score">0</span> |
    Fehler: <span id="fehler">0</span> |
    Zeit: <span id="time">30</span>s
  </div>
  <button id="startButton">Start</button>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const scoreEl = document.getElementById("score");
    const fehlerEl = document.getElementById("fehler");
    const timeEl = document.getElementById("time");
    const startButton = document.getElementById("startButton");

    let player = { x: 230, y: 340, width: 40, height: 40, vy: 0, jumping: false };
    let flames = [];
    let score = 0;
    let fehler = 0;
    let time = 30;
    let playing = false;
    let countdown;

    function drawPlayer() {
      ctx.fillStyle = "red";
      ctx.fillRect(player.x, player.y, player.width, player.height);
    }

    function drawFlames() {
      ctx.fillStyle = "orange";
      flames.forEach(f => {
        ctx.beginPath();
        ctx.arc(f.x, f.y, f.size, 0, Math.PI * 2);
        ctx.fill();
      });
    }

    function update() {
      if (!playing) return;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Spieler Bewegung
      if (player.jumping) {
        player.vy += 0.5;
        player.y += player.vy;
        if (player.y >= 340) {
          player.y = 340;
          player.vy = 0;
          player.jumping = false;
        }
      }

      // Flammenbewegung
      flames.forEach(f => f.y += f.speed);

      // Kollision prüfen
      flames = flames.filter(f => {
        const hit = (
          f.x > player.x &&
          f.x < player.x + player.width &&
          f.y + f.size > player.y &&
          f.y - f.size < player.y + player.height
        );
        if (hit) {
          score++;
          scoreEl.textContent = score;
          return false;
        }
        if (f.y > canvas.height) {
          fehler++;
          fehlerEl.textContent = fehler;
          if (fehler >= 5) {
            endGame("Du hast zu viele Flammen verpasst!");
          }
          return false;
        }
        return true;
      });

      // Neue Flammen generieren
      if (Math.random() < 0.03 && flames.length < 5) {
        flames.push({
          x: Math.random() * (canvas.width - 20) + 10,
          y: -20,
          size: 15,
          speed: 1 + Math.random()
        });
      }

      drawPlayer();
      drawFlames();

      requestAnimationFrame(update);
    }

    function startGame() {
      player.y = 340;
      player.vy = 0;
      player.jumping = false;
      flames = [];
      score = 0;
      fehler = 0;
      time = 30;
      scoreEl.textContent = score;
      fehlerEl.textContent = fehler;
      timeEl.textContent = time;
      playing = true;

      clearInterval(countdown);
      countdown = setInterval(() => {
        time--;
        timeEl.textContent = time;
        if (time <= 0) {
          endGame("Zeit vorbei!");
        }
      }, 1000);

      requestAnimationFrame(update);
    }

    function endGame(message) {
      playing = false;
      clearInterval(countdown);
      alert(message + " Du hast " + score + " Punkte.");
    }

    // Steuerung
    document.addEventListener("keydown", (e) => {
      if (e.code === "Space" && !player.jumping && playing) {
        player.vy = -10;
        player.jumping = true;
      }
    });

    canvas.addEventListener("touchstart", (e) => {
      e.preventDefault();
      if (!player.jumping && playing) {
        player.vy = -10;
        player.jumping = true;
      }
    }, { passive: false });

    startButton.addEventListener("click", startGame);
    startButton.addEventListener("touchstart", startGame);
  </script>
</body>
</html>
